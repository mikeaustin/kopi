esc = (char 27)
print $ "[?25l"

positions = Vector $ 1..10 | flatMap (n) => [random () * 80, 0]
velocities = Vector $ 1..10 | flatMap (n) => [random () / 2 - 0.5, random ()]

loop (positions = positions) => {
  print $ esc "[2J"

  0..9 | each (index) => {
    positionX = positions.(index * 2)
    positionY = positions.(index * 2 + 1)
    velocityX = velocities.(index * 2)
    velocityY = velocities.(index * 2 + 1)

    stringX = '_toFixed (positionX % 80)
    stringY = '_toFixed (positionY % 20)

    print $ esc "[" stringY ";" stringX "H" "❄︎"
  }

  sleep (1 / 30)

  (positions + velocities)
}
