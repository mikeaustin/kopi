
# database = () => {
#   loop = (value) => {
#     print "loop"
#     yield (command, newValue) => match command (
#       "set" => database (newValue)
#       "get" => database (value)
#       _ => "nope"
#     )
#   }
#   loop (0)
# }

database = () => {
  loop = (value) => {
    value = yield (command, newValue) => match command (
      "set" => newValue
      "get" => value
    )
    loop (value)
  }
  loop (0)
}

db = spawn database

print (send db ("set", 5))
print (send db ("get", 0))
print (send db ("set", 10))
print (send db ("get", 0))
