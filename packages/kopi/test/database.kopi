select = fns => yield (x => match x fns)

database = () => {
  loop = (value) => {
    loop $ select (
      "get"           => value
      "set", newValue => newValue
    )
  }
  loop (0)
}

db = spawn database

print $ send db "get"
print $ send db "set", 5
print $ send db "get"
print $ send db "set", 10
print $ send db "get"
