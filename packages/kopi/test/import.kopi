import "test/basics.kopi"
import "test/database.kopi"
import "test/html.kopi"
import "test/async.kopi"

f, g = import "test/module.kopi"

# (f: f, g: g) = import "test/module.kopi"

print $ f ()


coroutine = () => {
  f, g = import "test/module.kopi"

  print $ f ()

  loop = (x) => {
    yield cmd => match cmd (
      "reload" => coroutine ()
      "eval"   => f x
    )
    loop (x + 1)
  }
  loop 1
}

co = spawn coroutine

# print $ send co "reload"
