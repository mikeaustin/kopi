print ""
print "== html =========================================="
print ""

html = props => children => ("element", "html", props, children)
body = props => children => ("element", "body", props, children)
ul = props => children => ("element", "ul", props, children)
li = props => children => ("element", "li", props, children)
text = value => ("text", value)

indent = (n) => {
  loop = (n, str) => match n (
    0 => str
    _ => loop (n - 1), (str ++ "  ")
  )
  loop (n, "")
}

generateHtmlString = (node, level) => {
  match node (
    "text", value => {
      indent level ++ string value ++ char 10
    }
    "element", tag, props, children => {
      inner = children | xmap child => generateHtmlString (child, level + 1)

      (indent level) ++ "<" ++ tag ++ ">" ++ (char 10) ++ (
        inner | xjoin ""
      ) ++ (indent level) ++ "</" ++ tag ++ ">" ++ (char 10)
    }
  )
}

"
  {spaces}<{tag}>
    {children | map (child) => generateHtmlString (child, level + 1)}
  {spaces}</{tag}>
"

documentTree = (
  html () [
    text "Hello"
    ul () [
      li () [(text 1)]
      li () [(text 2)]
    ]
  ]
)

htmlString = generateHtmlString (documentTree, 0)

print htmlString

export (
  generateHtmlString
  html
  body
  text
)
