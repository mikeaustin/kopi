receive = fns => wait (x => match x fns)

generator = () => \(
  loop = (x) => \(
    wait _ => x

    loop (x + 1)
  )

  loop (1)
)

x = spawn generator

print (send x ())
print (send x ())
print (send x ())


coroutine = () => \(
  loop = () => \(
    value = receive (
      0 => 1
      n => n * n
    )

    loop ()
  )

  loop ()
)

x = spawn coroutine

print (send x 1)
print (send x 2)
print (send x 3)
